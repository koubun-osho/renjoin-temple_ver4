# 蓮城院公式サイト 要件定義書【MVP版】

## 1. プロジェクト概要

### 1.1 プロジェクト名
蓮城院公式サイト 兼 副住職ブログ

### 1.2 目的
**MVP（Minimum Viable Product）として、以下を実現する：**
- 蓮城院の公式サイトとしての基本的な情報発信機能
- 副住職・荒木弘文氏のブログ運営機能
- セキュリティを最優先に確保した堅牢なシステム
- WordPressの制約を克服した高速でモダンなウェブサイト

### 1.3 ターゲットユーザー
- 檀家・信徒
- 地域住民
- 参拝希望者
- 副住職ブログの読者
- 仏教や寺院に興味を持つ一般の方々

## 2. 機能要件（MVP範囲）

### 2.1 コンテンツ管理（Sanity CMS）【最優先】
- **ブログ記事管理**
  - 記事の作成・編集・削除
  - 画像のアップロード
- **お知らせ管理**
  - お知らせの作成・編集・削除
- **固定ページ管理**
  - 由緒、年間行事、利用規約、プライバシーポリシーの編集
- **メディア管理**
  - 画像ファイルのアップロード・管理

### 2.2 公開ページ機能

#### トップページ（蓮城院公式サイト）
- **ヒーローセクション**: 境内写真背景に縦書きキャッチコピー
- **お知らせセクション**: 最新3件表示
- **由緒セクション**: 蓮城院の歴史と教えの簡潔な紹介
- **副住職ブログセクション**: 最新記事3件をカード形式で表示
- **アクセス情報**: 地図と交通手段

#### 寺院関連ページ
- **由緒・歴史ページ** (/about)
- **年間行事ページ** (/events) - テキストベースのリスト形式
- **お知らせ一覧ページ** (/news)
- **お問い合わせページ** (/contact) - メールアドレスと電話番号の記載のみ
- **利用規約ページ** (/terms)
- **プライバシーポリシーページ** (/privacy)

#### ブログセクション（副住職ブログ）
- **ブログ一覧ページ** (/blog)
  - 時系列での記事カード表示
  - シンプルなページネーション
- **個別記事ページ** (/blog/[slug])
  - 記事タイトル、公開日、本文、画像表示

### 2.3 Phase 2で実装予定の機能
- ブログの検索機能
- カテゴリー・タグによる絞り込み
- 目次・関連記事表示
- お問い合わせフォーム機能
- 構造化データ（JSON-LD）実装

## 3. 非機能要件

### 3.1 セキュリティ要件【最優先】
**開発の全段階において、セキュリティを最優先事項とする**

#### 3.1.1 機密情報管理
- **環境変数の利用**: SanityのAPIトークンやGoogle AnalyticsのIDは環境変数として管理
- **リポジトリ管理**: .env.localファイルは.gitignoreに記述し、Git管理対象から除外
- **ハードコード禁止**: 機密情報をソースコードに直接記述しない

#### 3.1.2 XSS対策
- **コンテンツサニタイズ**: Sanityから取得したリッチテキストをHTMLとして表示する際、必ずサニタイズライブラリ（DOMPurify等）を適用
- **入力値検証**: ユーザー入力を含む全てのコンテンツの無害化処理

#### 3.1.3 その他の脆弱性対策
- **SQLインジェクション**: Sanity（NoSQL）利用により原理的にリスクなし
- **CSRF**: MVP段階ではログイン機能なしのためリスク低、将来実装時に対策
- **個人情報処理**: サーバーサイドでの安全な処理

### 3.2 デザイン要件
- **参考サイト**: WordPressテーマ「Zen」（https://demo.tcd-theme.com/tcd113/）
- **デザインコンセプト**: 静かで荘厳な雰囲気を踏襲
- **特徴**: 縦書きテキスト、大きな余白、伝統的かつ洗練された印象
- **レスポンシブ**: PC、タブレット、スマートフォン対応

### 3.3 パフォーマンス要件
- **静的サイト生成（SSG）**: Next.jsを活用した高速化
- **画像最適化**: Next.jsの画像最適化機能を活用
- **ページ読み込み速度**: 3秒以内を目標

### 3.4 SEO要件（MVP範囲）
- **メタタグ**: 各ページに動的なタイトル、ディスクリプション設定
- **OGP対応**: SNSシェア時の表示最適化
- **サイトマップ**: sitemap.xmlの自動生成

### 3.5 分析要件
- **Google Analytics 4**: アクセス解析の導入

## 4. 技術スタック

### フロントエンド
- **フレームワーク**: Next.js (React + TypeScript)
- **スタイリング**: Tailwind CSS

### CMS
- **Sanity**: Headless CMS

### インフラ
- **ホスティング**: Vercel

### 分析
- **Google Analytics**: アクセス解析

## 5. 開発フェーズ（セキュリティ考慮版）

### Phase 0: 基盤構築とセキュリティ設定【最優先】
**目的**: 開発の土台を固め、機密情報を安全に管理する体制を最初に確立する
**期間**: 1週間

**主要タスク**:
- 各種アカウント作成（Sanity, Vercel, GitHub）
- Next.jsプロジェクト初期化とGitHubリポジトリ作成
- .gitignore設定（機密情報ファイルの除外）
- Sanityプロジェクト作成とAPIキー取得
- 環境変数設定（ローカル・Vercel両方）
- VercelとGitHubリポジトリ連携

### Phase 1: コンテンツ管理基盤（CMS）の構築
**目的**: ウェブサイトの「魂」となるコンテンツを入れるための器を完成させる
**期間**: 1週間

**主要タスク**:
- Sanityスキーマ定義（ブログ記事、お知らせ、固定ページ）
- Sanity Studio（管理画面）の設定
- テスト用コンテンツの登録

### Phase 2: コア機能（ブログ）の実装
**目的**: サイトの中心機能であるブログをCMSと連携させて表示
**期間**: 1週間

**主要タスク**:
- ヘッダー・フッター共通コンポーネント作成
- Sanityクライアント設定
- 個別記事ページ実装（XSS対策含む）
- ブログ一覧ページ実装

### Phase 3: 静的ページとトップページの構築
**目的**: ブログ以外の寺院公式サイトとしての体裁を整える
**期間**: 1週間

**主要タスク**:
- 固定ページの実装（由緒、利用規約など）
- お知らせ一覧ページ実装
- トップページ実装（お知らせ・ブログ統合表示）

### Phase 4: 最終調整と公開
**目的**: 公開に向けて、SEOや分析ツールなどの仕上げを行う
**期間**: 1週間

**主要タスク**:
- レスポンシブデザイン対応確認・調整
- SEO要件実装（メタタグ、OGP、サイトマップ）
- Google Analytics導入
- 最終動作確認とテスト
- 独自ドメイン設定と本番リリース

## 6. ブラウザ対応

### デスクトップ
- Chrome 最新版
- Firefox 最新版
- Safari 最新版
- Edge 最新版

### モバイル
- iOS Safari 14以上
- Android Chrome 最新版

## 7. 制約事項（MVP版）
- 初期段階では日本語のみ対応
- フォーム機能は実装しない（Phase 2で対応）
- 決済機能は実装しない
- 会員登録機能は実装しない
- 高度なSEO対策（構造化データ）はPhase 2で対応

## 8. 成功指標
- **セキュリティ**: 脆弱性診断で重大な問題なし
- **パフォーマンス**: PageSpeed Insights 90点以上
- **モバイル対応**: モバイルフレンドリーテスト100%合格
- **機能**: ブログとお知らせの投稿・表示が正常動作
- **アクセス**: 公開後1ヶ月で基本的なアクセス解析データ取得開始